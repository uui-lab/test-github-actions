on: push
jobs:
  main:
    runs-on: ubuntu-20.04
    steps:
      - run: wget https://dl.google.com/linux/direct/chrome-remote-desktop_current_amd64.deb
      - run: sudo apt install -y ./chrome-remote-desktop_current_amd64.deb
      - run: sudo apt install -y xubuntu-desktop
      - run: sudo usermod -a -G chrome-remote-desktop $USER
      - run: echo "exec startxfce4" > ~/.chrome-remote-desktop-session
      - run: mkdir -p ~/.config/chrome-remote-desktop
      - run: sudo chown $USER:$USER ~/.config/chrome-remote-desktop
      - run: sudo chmod a+rwx ~/.config/chrome-remote-desktop
      - run: DISPLAY= /opt/google/chrome-remote-desktop/start-host --code="4/0AZEOvhX0fe9_hSQ-51HuFz8gnE8o88G7uXC0NAEP32CFOx4-sw0F1dpnsSDH9uxSUJU6PQ" --redirect-url="https://remotedesktop.google.com/_/oauthredirect" --name=$(hostname) --pin=123456
      - run: while true; do :; done